<!DOCTYPE html>
<html lang="">
<head>
    <title>Food Truck Finder</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <link href="homePage.css" rel="stylesheet">
    <link href="topten.css" rel="stylesheet">
    <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
    <script src="homePage.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
    <script src="restaurant.js"></script>
</head>
<body>
<!-- This part is for the search box-->
<div class="search-box" id="searchBox_div">
    <input class="search-txt" name="" placeholder="Search for food truck" type="text"/>
    <a class="search-btn" href="#">
        <i class="fas fa-search"></i>
    </a>
</div>

<!-- This part is for maps using google API-->
<div id="map"></div>

<button onclick="calcl()">calculate</button>

<p id="demo" style="font-size: 15px; font-family: raleway;padding: 2% 0%;"></p>



<p id="restn0" style="display: none; font-size: 36px;">
1191 - 1137 S Halsted St<br>Chicago, IL 60607 <br>
1199 - 1131 Michigan Avenue<br>Chicago, IL 60605
 
</p>
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCqV-VCvruObpZgGWmyGLAnJYgiLnNer-I&callback=initMap">
</script>
<script>
    var map, infoWindow;
    function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
            center: {lat: -34.397, lng: 150.644},
            zoom: 6
        });
        infoWindow = new google.maps.InfoWindow;
        // Try HTML5 geolocation.
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                var pos = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };
                infoWindow.setPosition(pos);
                infoWindow.setContent('Location found.');
                infoWindow.open(map);
                map.setCenter(pos);
            }, function() {
                handleLocationError(true, infoWindow, map.getCenter());
            });
        } else {
            // Browser doesn't support Geolocation
            handleLocationError(false, infoWindow, map.getCenter());
        }
		LoadItems();
    }
    function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
            'Error: The Geolocation service failed.' :
            'Error: Your browser doesn\'t support geolocation.');
        infoWindow.open(map);
    }
</script>

<div class="shopping-cart" id="List_Hotels">
<!-- start list-->

<!-- end list-->


</div>

<div class="" style="height:80px"></div>

<div class="navbar" style="position:fixed;     bottom: 0;        width: 375px;    background: white;">
    <div class="item" id="top10_div">
        <div class="fa fa-user"></div>
        <div class="label">Top 10</div>
    </div>
    <div class="item" id="favorites_div">
        <div class="fa fa-star"></div>
        <div class="label">Favorites</div>
    </div>
    <div class="item" id="filter_div">
        <div class="fa fa-filter"></div>
        <div class="label">Filters</div>
    </div>
    <div class="item" id="nearby_div">
        <div class="fa fa-globe"></div>
        <div class="label">Nearby</div>
    </div>
</div>















<script>
function LoadItems(){
    var list_of_Hotels = Restaurants;
    var MarkersList = [];
var loopCounter= 10;
if(list_of_Hotels.length<9)
{
loopCounter=list_of_Hotels.length;
}

var sorted =  list_of_Hotels.sort(compare);
for(var i= 0 ; i<loopCounter; i++){

var string =' <a style="text-decoration:none; color:inherit;" href="restaurantView.html?id='+sorted[i].id+'" class="item_"><div class="buttons"><span>#'+(i+1)+'</span></div>';
string += '<div class="image"> <i class="icon_ fas fa-utensils"></i></div>';
string += '<div class="description"><span>' + sorted[i].name + '</span>';

sorted[i].schedule.forEach(
           function (u) {
               var uluru = {lat: u[1], lng: u[2]};

               string += '<span>' + u[0] + '</span>';
               var infoWindowContent = '<div id="map-player-info-content">' +
    
                  '<p><span class="text-bold"></span> ' +sorted[i].name+ '</p>' +
                  


                  '<p><span class="text-bold"></span> ' + u[0]+ '</p>' +
                  '<p><span class="text-bold"></span> ' + sorted[i].rating+ '/5 <i class="fa fa-star"></i></p>' +
                  '</div>';
               var marker_= new google.maps.Marker({position: uluru, map: map ,title: sorted[i].HotelName});
               MarkersList.push(marker_);

  
               (function (marker_, infoWindowContent) {
                   google.maps.event.addListener(marker_, "click", function (e) {
                       //Wrap the content inside an HTML DIV in order to set height and width of InfoWindow.
                       infoWindow.setContent(infoWindowContent);
                       infoWindow.open(map, marker_);
                   });
               })(marker_, infoWindowContent);
           });
string+='</div>';
string+='<div class="total-price">'+sorted[i].rating+'/5<i class="fa fa-star"></i></div></a>';
document.getElementById("List_Hotels").innerHTML+= string;
}
var bounds = new google.maps.LatLngBounds();
for (var i = 0; i < MarkersList.length; i++) {
    bounds.extend(MarkersList[i].getPosition());
}

map.fitBounds(bounds);
}

function compare(a, b){
    const ratingA = a.rating;
    const ratingB = b.rating;

  let comparison = 0;
  if (ratingA < ratingB) {
    comparison = 1;
  } else if (ratingA > ratingB) {
    comparison = -1;
  }
  return comparison;
}















var p;
    var q;
var rest0,rest1,rest2,rest3,rest4,rest5,rest6,rest7,rest8,rest9,rest10,rest11;

function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.watchPosition(showPosition);
  } else { 
    x.innerHTML = "Geolocation is not supported by this browser.";
  }
}
    
function showPosition(position) {

   p= position.coords.latitude; 
    q= position.coords.longitude; 
   
    
  
}
getLocation()

function calcl() {

 Number.prototype.toRad = function() {
   return this * Math.PI / 180;
}


////// "Power Breakfast Truck"/////----0
var lat2 = p; 
var lon2 = q; 

var lat1 = 41.867354; 
var lon1 = -87.647072; 

var R = 6371; // km 

var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
                Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
 d = d.toFixed(2);
 rest0=d;


//restn0="1191 - 1137 S Halsted St"+"<br>"+"Chicago, IL 60607" +"<br>"+"<br>"+
//  "1199 - 1131 Michigan Avenue"+"<br>"+"Chicago, IL 60605";








///////////"Desert-a-truck"///////--------1

var lat2 = p; 
var lon2 = q; 

var lat1 = 41.878273; 
var lon1 = -87.627517; 

var R = 6371; // km 
var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
d = d.toFixed(2);
rest1=d;

     









///////////"Dhaba"///////-----------2

var lat2 = p; 
var lon2 = q; 

var lat1 = 41.880781; 
var lon1 = -87.624081; 

var R = 6371; // km 
var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
d = d.toFixed(2);
 rest2=d;



///////////"Ameer Nawaz"///////--------3

var lat2 = p; 
var lon2 = q; 

var lat1 =41.8916; 
var lon1 =-87.6252; 

var R = 6371; // km 
var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
d = d.toFixed(2);
 rest3=d;




/////////// "HALAL-Food-truck"///////---------4

var lat2 = p; 
var lon2 = q; 

var lat1 =  41.878264; 
var lon1 = -87.626082; 

var R = 6371; // km 
var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
d = d.toFixed(2);
 rest4=d;



///////////"Sushi-Thai-truck""///////-----5

var lat2 = p; 
var lon2 = q; 

var lat1 = 41.882821; 
var lon1 = -87.624752; 

var R = 6371; // km 
var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
d = d.toFixed(2);
 rest5=d;



///////////"Italian-Food-truck"///////-----------6

var lat2 = p; 
var lon2 = q; 

var lat1 = 41.879347; 
var lon1 = -87.657865; 

var R = 6371; // km 
var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
d = d.toFixed(2);
 rest6=d;



///////////"Korean-Food-truck"///////----------7

var lat2 = p; 
var lon2 = q; 

var lat1 = 41.921170; 
var lon1 = -87.710270; 

var R = 6371; // km 
var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
d = d.toFixed(2);
 rest7=d;



///////////"Gelato-ICE-truck"///////--------8

var lat2 = p; 
var lon2 = q; 

var lat1 = 41.899062; 
var lon1 = -87.706530; 

var R = 6371; // km 
var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
d = d.toFixed(2);
 rest8=d;




///////////"Taco-Food-truck"///////--------9

var lat2 = p; 
var lon2 = q; 

var lat1 = 41.881537; 
var lon1 = -87.705538; 

var R = 6371; // km 
var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
d = d.toFixed(2);
 rest9=d;



///////////"Sushi-Burrito-truck"///////---------10

var lat2 = p; 
var lon2 = q; 

var lat1 = 41.877183; 
var lon1 = -87.627989; 

var R = 6371; // km 
var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
d = d.toFixed(2);
 rest10=d;




///////////" "Mix-Burger-truck""///////---------11

var lat2 = p; 
var lon2 = q; 

var lat1 =41.893784; 
var lon1 = -87.619157; 

var R = 6371; // km 
var x1 = lat2-lat1;
var dLat = x1.toRad();  
var x2 = lon2-lon1;
var dLon = x2.toRad();  
var a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
Math.sin(dLon/2) * Math.sin(dLon/2);  
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
d = d.toFixed(2);
 rest11=d;






var  restaurant = [
  {
    type:"<span style='font-size:24px;'>Power Breakfast Truck</span>"+"<br>"+restn0.innerHTML +"<br>", 
    distance:rest0
  },
  {type:"Desert-a-truck", distance:rest1},
  {type:"Dhaba", distance:rest2},
  {type:"Ameer Nawaz", distance:rest3},
  {type:"HALAL-Food-truck", distance:rest4},
  {type:"Sushi-Thai-truck", distance:rest5},
  {type:"Italian-Food-truck", distance:rest6},
  {type:"Korean-Food-truck", distance:rest7},
  {type:"Gelato-ICE-truck", distance:rest8},
  {type:"Taco-Food-truck", distance:rest9},
  {type:"Sushi-Burrito-truck", distance:rest10},
  {type:"Mix-Burger-truck", distance:rest11},
  

];

displayrestaurant();

function myFunction() {
   restaurant.sort(function(a, b){return a.distance - b.distance});
  displayrestaurant();
}
myFunction()
function displayrestaurant() {
demo.innerHTML =  
  "#1"+ restaurant[0].type + ":- " +  restaurant[0].distance + "KM" +"<br>"  + "<hr>" +
restaurant[1].type + " :-" +  restaurant[1].distance + "KM" +"<br>" +
   restaurant[2].type + ":- " +  restaurant[2].distance + "KM" +"<hr>" +
   restaurant[3].type + ":- " +  restaurant[3].distance + "KM" +"<hr>" +
   restaurant[4].type + ":- " +  restaurant[4].distance + "KM" +"<hr>" +
  restaurant[5].type + ":- " +  restaurant[5].distance + "KM" +"<hr>" +
   restaurant[6].type + ":- " +  restaurant[6].distance + "KM" +"<hr>" +
   restaurant[7].type + ":- " +  restaurant[7].distance + "KM" +"<hr>" +
   restaurant[8].type + ":- " +  restaurant[8].distance + "KM" +"<hr>" +
   restaurant[9].type + ":- " +  restaurant[9].distance + "KM" +"<hr>" +
   restaurant[10].type + ":-" +  restaurant[10].distance +"KM" + "<hr>" +
  "#1"+"    " +restaurant[11].type + "     " +  restaurant[11].distance ;
}

}
























</script>
</body>
</html>